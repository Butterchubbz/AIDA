<!DOCTYPE html>
<html>
<head>
    <title>AIDA Status</title>
    <style>
        body { font-family: sans-serif; }
        .service { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; }
        .status { font-weight: bold; }
        .status.running { color: green; }
        .status.stopped { color: red; }
        .status.error { color: orange; }
    </style>
</head>
<body>
    <h1>AIDA Status</h1>
    <div class="service">
        <h2>PocketBase</h2>
        <p>Status: <span id="pocketbase-status" class="status stopped">Stopped</span></p>
        <button id="pocketbase-start">Start</button>
        <button id="pocketbase-stop">Stop</button>
    </div>
    <div class="service">
        <h2>AIDA Frontend</h2>
        <p>Status: <span id="aida-status" class="status stopped">Stopped</span></p>
        <button id="aida-start">Start</button>
        <button id="aida-stop">Stop</button>
    </div>
    <button id="launch-aida">Launch AIDA</button>

    <script>
        const pocketbaseStatus = document.getElementById('pocketbase-status');
        const aidaStatus = document.getElementById('aida-status');

        document.getElementById('pocketbase-start').addEventListener('click', () => {
            window.electronAPI.startPocketbase();
        });

        document.getElementById('pocketbase-stop').addEventListener('click', () => {
            window.electronAPI.stopPocketbase();
        });

        document.getElementById('aida-start').addEventListener('click', () => {
            window.electronAPI.startAida();
        });

        document.getElementById('aida-stop').addEventListener('click', () => {
            window.electronAPI.stopAida();
        });

        document.getElementById('launch-aida').addEventListener('click', () => {
            window.electronAPI.launchAida();
        });

        window.electronAPI.onPocketbaseStatus((status, error) => {
            pocketbaseStatus.textContent = status;
            pocketbaseStatus.className = `status ${status}`;
            if (status === 'error') {
                pocketbaseStatus.textContent += `: ${error}`;
            }
        });

        window.electronAPI.onAidaStatus((status, portOrError) => {
            aidaStatus.textContent = status;
            aidaStatus.className = `status ${status}`;
            if (status === 'running') {
                aidaStatus.textContent += ` on port ${portOrError}`;
            }
            if (status === 'error') {
                aidaStatus.textContent += `: ${portOrError}`;
            }
        });

        window.electronAPI.onSetupComplete(() => {
            console.log('Setup complete');
        });

        window.electronAPI.onSetupError((error) => {
            console.error(`Setup error: ${error}`);
        });

        window.electronAPI.checkSetup();
    </script>
</body>
</html>